# Wireshark Preferences for Network Security Analysis
# Network Traffic Analysis Toolkit v2.1.0
# 
# This configuration file optimizes Wireshark for security analysis,
# credential hunting, and network forensics. Copy this to your Wireshark
# preferences directory or import via Edit -> Preferences -> Import.
#
# Location:
# Linux: ~/.config/wireshark/preferences
# macOS: ~/Library/Application Support/Wireshark/preferences  
# Windows: %APPDATA%\Wireshark\preferences

##################################################
# GENERAL INTERFACE PREFERENCES
##################################################

# Language and Interface
gui.qt.language: "en"
gui.recent_df_entries_max: 100
gui.recent_files_count_max: 100
gui.fileopen_remembered_dir: "."
gui.fileopen_style: 1

# Main Window Layout
gui.geometry_main_maximized: TRUE
gui.geometry_main_width: 1200
gui.geometry_main_height: 800
gui.mainmenu_enabled: TRUE
gui.packet_list_separator: TRUE

# Time Display Format (crucial for security analysis)
gui.time_format: 1
gui.time_precision: 6
gui.seconds_format: 1

##################################################
# PACKET LIST AND DETAILS PREFERENCES
##################################################

# Packet List Columns (optimized for security analysis)
gui.column.format: 
  "No.", "%m",
  "Time", "%Yt",
  "Source", "%s", 
  "Destination", "%d",
  "Protocol", "%p",
  "Length", "%L",
  "Info", "%i"

# Additional useful columns for security analysis
# Uncomment these lines if you want more detailed columns:
# "Src Port", "%us",
# "Dst Port", "%ud", 
# "HTTP Method", "%Cus:http.request.method",
# "HTTP Response", "%Cus:http.response.code"

# Packet List Appearance
gui.packet_list_colorize: TRUE
gui.colorized_frame.bg: 255
gui.colorized_frame.fg: 0
gui.marked_frame.bg: 16711935
gui.marked_frame.fg: 16777215

# Tree View Preferences
gui.tree_view_altern_colors: TRUE
gui.expert_composite_eyecandy: TRUE

##################################################
# PROTOCOL DISSECTION PREFERENCES
##################################################

# TCP Preferences (critical for credential analysis)
tcp.desegment_tcp_streams: TRUE
tcp.analyze_sequence_numbers: TRUE
tcp.relative_sequence_numbers: TRUE
tcp.track_bytes_in_flight: TRUE
tcp.calculate_timestamps: TRUE
tcp.try_heuristic_first: TRUE
tcp.check_checksum: TRUE

# HTTP Preferences (essential for web traffic analysis)
http.desegment_headers: TRUE
http.desegment_body: TRUE
http.dechunk_body: TRUE
http.decompress_body: TRUE
http.tls_port: 443
http.tcp.port: 80

# HTTP Additional Ports (common alternate HTTP ports)
http.tcp.ports: "80,8000,8008,8080,8088,8888"

# SSL/TLS Preferences (for encrypted traffic analysis)
ssl.desegment_ssl_records: TRUE
ssl.desegment_ssl_application_data: TRUE
ssl.ignore_ssl_mac_failed: FALSE
ssl.keylog_file: ""
ssl.debug_file: ""

# DNS Preferences (important for threat detection)
dns.desegment_dns_messages: TRUE
dns.use_for_addr_resolution: TRUE

# FTP Preferences (for credential hunting)
ftp.desegment_command_lines: TRUE
ftp.desegment_data: TRUE

# SMTP Preferences (email security analysis)
smtp.desegment_lines: TRUE
smtp.desegment_data: TRUE

# SSH Preferences (for authentication analysis)
ssh.desegment_ssh_buffers: TRUE
ssh.decode_ssh2_publickey: TRUE

# SMB Preferences (for Windows network analysis)  
smb.trans_reassembly: TRUE
smb.dcerpc_reassembly: TRUE
smb.sid_name_resolving: TRUE

##################################################
# SECURITY ANALYSIS SPECIFIC SETTINGS
##################################################

# Enable Expert Info (critical for anomaly detection)
expert.composite_summary: TRUE
expert.group_by_summary: TRUE

# Checksum Verification (detect tampering)
ip.check_checksum: TRUE
tcp.check_checksum: TRUE  
udp.check_checksum: TRUE
icmp.check_checksum: TRUE

# Flow Analysis
flow.show_labels: TRUE
stats.flow_graph_show_labels: TRUE

##################################################
# NAME RESOLUTION PREFERENCES
##################################################

# Network Name Resolution (balance performance vs information)
nameres.network_name: TRUE
nameres.transport_name: TRUE
nameres.concurrent_dns: 50
nameres.dns_pkt_addr_resolution: TRUE
nameres.use_external_name_resolver: FALSE
nameres.hosts_file_handling: TRUE

# MAC Name Resolution
nameres.mac_name: TRUE
nameres.load_manuf_file: TRUE

# Resolve specific types
nameres.resolv_duration: 60000

##################################################
# CAPTURE PREFERENCES (for live analysis)
##################################################

# Capture Interface Settings
capture.prom_mode: TRUE
capture.pcap_ng: TRUE
capture.real_time_update: TRUE
capture.auto_scroll: TRUE

# Ring Buffer Settings (for continuous capture)
capture.ring_num_files: 10
capture.file_duration: 3600

# Capture Filters (pre-configured for security analysis)
# These are default capture filter suggestions
capture.main_welcome_recent_capture_files_max: 10

##################################################
# DISPLAY AND APPEARANCE
##################################################

# Font Settings
gui.qt.font_name: "Monaco,10,-1,5,50,0,0,0,0,0"

# Color Rules for Security Analysis
# Critical Security Events (red background)
gui.colorfilter.colorfilters: 
  "name=SSH Failures,filter=ssh and tcp.analysis.retransmission,fore=65535,65535,65535,back=65535,0,0,disabled=false",
  "name=HTTP 401/403,filter=http.response.code == 401 or http.response.code == 403,fore=65535,65535,65535,back=65535,0,0,disabled=false",
  "name=FTP Failures,filter=ftp.response.code >= 530 and ftp.response.code <= 539,fore=65535,65535,65535,back=65535,0,0,disabled=false",
  "name=DNS Suspicious,filter=dns and frame.len > 512,fore=0,0,0,back=65535,65535,0,disabled=false",
  "name=HTTP POST,filter=http.request.method == POST,fore=0,0,0,back=0,65535,0,disabled=false",
  "name=Credentials,filter=frame contains password or frame contains username,fore=65535,65535,65535,back=16711680,disabled=false"

##################################################
# STATISTICS AND ANALYSIS
##################################################

# Statistics preferences
stats.tap_update_interval: 3000
gui.update.interval: 100

# Graph settings
gui.io_graph_enable_legend: TRUE
gui.io_graph_automatic_update: TRUE

##################################################
# SECURITY PROFILES
##################################################

# Profile: Credential Hunting
# Optimized for detecting credentials in network traffic
# Enable these dissectors for credential analysis:
protocols.display_filter.protocols: "http,ftp,smtp,pop,imap,ssh,telnet,snmp"

# Profile: Malware Analysis  
# Settings optimized for analyzing malicious traffic
# Enable advanced DNS analysis
dns.snoop_compress: TRUE
dns.use_decode_nss: TRUE

##################################################
# ADVANCED PREFERENCES
##################################################

# Memory Management
gui.max_export_objects: 1000
extcap.display_in_gui: TRUE

# File and Export Preferences
gui.fileopen_dir: ""
gui.fileopen_filename: ""
gui.use_native_open_dialog: TRUE

# Recent Files Management
gui.recent.common.privs_warn_if_elevated: TRUE
gui.recent.common.privs_warn_if_no_npf: TRUE

##################################################
# CUSTOM PREFERENCE ADDITIONS
##################################################

# Custom preference for security analysis workspace
# These are toolkit-specific enhancements

# Enhanced Expert Analysis
gui.expert.colorize: TRUE
gui.expert.indicators: TRUE

# Protocol Preference Overrides for Security Analysis
# Force analysis of protocols that might be disguised
http.tcp.alternate_port: "8000,8008,8080,8088,8443,8888,9000,9080,9090"
ssl.port: "443,465,993,995,8443,9443"

# Custom Columns for Security Analysis (advanced users)
# Add these manually via View -> Columns if needed:
# Column Type: Custom, Field: http.request.method, Title: HTTP Method
# Column Type: Custom, Field: http.response.code, Title: HTTP Code  
# Column Type: Custom, Field: tcp.flags, Title: TCP Flags
# Column Type: Custom, Field: frame.time_delta, Title: Time Delta

##################################################
# PERFORMANCE TUNING
##################################################

# Buffer and Performance Settings
gui.update.interval: 100
capture.update_interval: 100

# Memory usage optimization  
gui.io_graph_enable: TRUE
gui.follow_stream_show_as: 0

##################################################
# NOTES AND USAGE INSTRUCTIONS
##################################################

# How to use this configuration:
#
# 1. BACKUP your existing preferences first:
#    Linux: cp ~/.config/wireshark/preferences ~/.config/wireshark/preferences.backup
#    macOS: cp ~/Library/Application\ Support/Wireshark/preferences ~/preferences.backup
#    Windows: copy "%APPDATA%\Wireshark\preferences" preferences.backup
#
# 2. COPY this file to your Wireshark preferences location OR
#    Use Wireshark: Edit -> Preferences -> Import Configuration
#
# 3. RESTART Wireshark to apply all settings
#
# 4. CUSTOMIZE as needed for your specific environment
#
# Key Features Enabled:
# - Optimized for credential hunting and security analysis
# - Enhanced protocol dissection for common attack vectors
# - Color coding for security-relevant traffic
# - Proper time formatting for forensic analysis
# - Expert info enabled for anomaly detection
# - Optimized column layout for security analysis

##################################################
# SECURITY FILTER PRESETS
##################################################

# These display filters are pre-configured for common security analysis tasks:
# Copy these to your display filter toolbar:

# "Credentials" -> "frame contains \"password\" or frame contains \"username\""
# "HTTP Auth" -> "http.authorization or http.www_authenticate"  
# "Failed Auth" -> "http.response.code == 401 or http.response.code == 403"
# "FTP Auth" -> "ftp.request.command == \"USER\" or ftp.request.command == \"PASS\""
# "SSH Activity" -> "ssh"
# "DNS Large" -> "dns and frame.len > 512"
# "Port Scans" -> "tcp.flags.syn == 1 and tcp.flags.ack == 0"
# "Retransmissions" -> "tcp.analysis.retransmission"

# End of configuration file
# Last updated: 2024-09-18
# Version: 2.1.0
# Network Traffic Analysis Toolkit